Show the existence of low-distortion embeddings of arbitrary finite metric spaces.

\textbf{Definition}
    Let $(X,d_X)$ and $(Y,dY)$ be a metric spaces and $f:X \to Y$ a map between them. Distortion is the smallest positive $\rho$ such that for some c and $\forall x_1, x_2 \in X$
    $$
        cd_X(x_1,x_2) \leq d_Y(f(x_1), f(x_2)) \leq \rho c d_X(x_1,x_2)    
    $$

\textbf{Theorem} (Bourgain). For any finite metric space $(X,d)$ of size $|X| = n$, there is an embedding $f:X\to \mathbb{R}^m$ with $m\in\Theta(\log^2n)$ such that
$$
    |f_i(x) - f_i(y)| \leq d(x,y) \qquad
    \|f(x) -f(y)\|_1 \in \Omega( (\log n)d(x,y) )
$$
Moreover, the distortion is $O(\log n)$ for any $\ell_p$ metric on $\mathbb{R}^m$, $p\geq 1$.

\textit{a)} Using Hölder's inequality, show that $\ell_1$ previous results imply the conslusion for all $p$.

\textbf{Proof} - Hölder's inequality says, for any $p,q \in [1,\infty]$ with $1/p + 1/q = 1$, for any $f,g \in X$,
$$
    \|fg\|_1 \leq \|f\|_p\|g\|_q
$$

Let $\v = f(x) - f(y) \in \mathbb{R}^m$, thanks to Hölder's inequality, we have $q = p/(p - 1)$, and
$$
\begin{aligned}
    \|\v\|_1 = \|\v\mathbf{1}\|_1 &<
    \|v\|_p\|\mathbf{1}\|_q\\
    &= \|v\|_p\left(
        \sum_i^m |1|^q
    \right)^\frac{1}{q}\\
    &= \|\v\|_p m^\frac{1}{q}\\
    \|\v\|_1 &\leq m^{1 - 1/p}\ \|\v\|_p\\
\end{aligned}
$$

Also, in general, $\|\x\|_p \leq \dots \leq \|\x\|_2 \leq \|\x\|_1$ for any finite $\x$. Thus, $\|\v\|_p \leq \|\v\|_1$, and we can bound $\|\v\|_p$ by an upper and lower limit.
$$
    m^{\frac{1}{p} - 1}\|\v\|_1 \leq \|\v\|_p \leq \|\v\|_1
$$
Now, using Bourgain theorem we have that there exists some $A > 0$, such that,
$$
    |v_i| \leq d(x,y) \qquad A\log{n}\ d(x,y) \leq \|\v\|_1
$$
Taking the first property, we can define another upperbound for $\|\v\|_p$ as,
$$
    \|\v\|_p = \left( \sum_i^m |v_i|^p \right)^\frac{1}{p} \leq \left( \sum_i^m d^p(x,y) \right)^\frac{1}{p} = m^\frac{1}{p} d(x,y)
$$
and, taking the second property, we can conclude that
$$
    m^{\frac{1}{p} - 1} A \log{n}\ d(x,y) \leq \|\v\|_p \leq m^\frac{1}{p} d(x,y)
$$

With $c = m^{\frac{1}{p} - 1} A \log{n}$, the distortion satisfies:
$$
    \rho \leq \frac{m}{A\log{n}}
$$

Since $m = \Theta(\log^2 n)$, then $\rho = O(\log{n})$.

\textit{b)} The map $f$ can be built up from the distances themselves. Show that if $S_i$ is any nonempty subset of $X$ and
$$
    f_i(x) := d(x,S_i) := \min_{y\in S_i} d(x,y),
$$
then $|f_i(x) - f_i(y)| \leq d(x,y)$ holds.

\textbf{Proof} - Let $x, y \in X$, and $S \subseteq X$ with $S\neq \emptyset$ and $z \in S$. Also let $f(x) := \min_{z\in S} d(x,z)$. Then, using the triangle inequality we have,
$$
\begin{aligned}
    d(x,z) &\leq d(x,y) + d(y,z)\\
    f(x) := \min_{z\in S} d(x,z) &\leq d(x,y) + \min_{z\in S} d(y,z)\\
    f(x) &\leq d(x,y) + f(y)\\
    f(x) - f(y) &\leq d(x,y)\\
\end{aligned}
$$

Similarly, we can prove $f(y) - f(x) \leq d(x,y)$, thus
$$
    |f(x) - f(y)| \leq d(x,y) \qquad \text{for} \ f(s) := d(x,S)
$$

\textit{c)} The construction of the sets $S_i$ and the proof of $\|f(x) - f(y)\|_1 \in \Omega( \log{n}\ d(x,y) )$, rely on a probabilistic argument. The basic idea is to sample enough subsets $S_i$ to separate any given pair of points $x$ and $y$.
Suppose a subset $S\subset X$ is sampled as $\mathbb{P}(x \in S) = 1/k$ independently for each $x \in X$, where $k \geq 2$. Let $B$ be a fixed subset of $X$. Show that
$$
\begin{aligned}
    |B| &\geq \alpha k \Longrightarrow \mathbb{P}(B\cap S \neq \emptyset ) \geq 1 - e^{-\alpha} > 0\\ 
    |B| &\leq \alpha k \Longrightarrow \mathbb{P}(B\cap S = \emptyset ) \geq 4^{-\alpha} > 0\\ 
\end{aligned}
$$

\textbf{Proof} - Each element in $S$ is included independently, with probability $1/k$ the probability that $x \in S \land x \notin B$ is
$$
    \mathbb{P}(B \cap S = \emptyset) = \left( 1 - \frac{1}{k} \right)^{|B|}
$$
whereas the probability that $x \in S \land x \in B$
$$
    \mathbb{P}(B \cap S \neq \emptyset) = 1 - \left( 1 - \frac{1}{k} \right)^{|B|}
$$
First, we can assume that if $|B| \geq \alpha k$,
$$
    \left( 1 - \frac{1}{k} \right)^{|B|} \leq
    \left( 1 - \frac{1}{k} \right)^{\alpha k} \leq
    e^{-\alpha}
$$
using the $e^{\alpha}$ definition. Thus,
$$
    \boxed{ \mathbb{P}(B \cap S \neq \emptyset) = 1 - \left( 1 - \frac{1}{k} \right)^{|B|} \geq 1 - e^{-\alpha} > 0 }
$$
Second, if $|B| \leq \alpha k$ then
$$
    \mathbb{P}(B \cap S = \emptyset) = \left( 1 - \frac{1}{k} \right)^{|B|} \geq 
    \left( 1 - \frac{1}{k} \right)^{\alpha k}
$$
For $k \geq 2$,
$$
    \left( 1 - \frac{1}{k} \right)^k \geq \left( 1 - \frac{1}{2} \right)^2 = \frac{1}{4}
$$
and finally,
$$
    \boxed{ \mathbb{P}(B \cap S = \emptyset) \geq 4^{-\alpha} }
$$

\textit{d)} For each $i \in \{ 1, \dots, \log_2\ n \}$, sample a subset $S_i$ as follows: $\mathbb{P}(x \in S_i) = 2^{-i}$ independently for each $x \in X$. Defining $f_i(x) = d(x,S_i)$ as above, show that for a fixed pair $x,y \in X$,
$$
    \mathbb{E}\left[ \sum_i |f_i(x) - f_i(y) | \right] \in \Omega(d(x,y)),
$$
where the expectation is taken over the sets $S_i$.

\textbf{Proof} - Let $x,y \in X$ be fixed, thus $d(x,y)$ is fixed. $X$ can be covered by dyadic balls $B_x^{j} = \{ z \in X, d(x,z) < 2^{j} d(x,y) \}$, which double their radius. Being $n = |X|$, we can cover $X$ with at most a ball with $j = \log_2\ n$. We can also define disjoint annullar sets $A_x^j = B_x^j \setminus B_x^{j-1}$ with $A_x^0 = B_0^0$. Thus,
$$
    A_0 := \{ z \in X,\quad d(x,z) < d(x,y) \}
$$
and,
$$
    A_j := \{ z \in X,\quad 2^{j-1}d(x,y) \leq d(x,z) < 2^{j}d(x,y) \}
$$

Recall that $\forall z,w \in X, |f_i(z) - f_i(w)| \leq d(z,w)$, with $f_i(z) := d(z,S_i)$, with $S_i$ being a random sampling of $X$ with independent probability $2^-i$. Let's fix $j$ and look at the contribution to $|f_i(x) - f_i(y)|$ arising from points $z \in A_x^j$.

\begin{itemize}
    \item If $S_i \cap A_x^j \neq \emptyset$, then $f_i(x)$ is at most $2^jd(x,y)$. Also, if $S_i$ contains no element at a distance closer to $2^{j-1}$ from $y$, then
    $$
        |f_i(x) - f_i(y)| < 2^{j-1}d(x,y)
    $$
    because $f_i(x) \leq 2^r d(x,y)$ and $f_i(y) \geq 2^{j-1}d(x,y)$, with symmetry in $x,y$.
\end{itemize}

Let the size of $B_x^{j}$ and $B_y^{j}$ be the probabilities that $S_i$ hits one of $x,y$ but not the other. From previous problem, having $k = 2^i$,
\begin{itemize}
    \item If $|B_x^j| \geq \alpha \cdot 2^i$, and  $|B_y^j| \leq \alpha \cdot 2^i$,
    $$
        \mathbb{P}(S_i \cap B_x^j \neq \emptyset \land S_i \cap B_y^j = \emptyset ) \geq
        (1 - e^{-\alpha})\cdot 4^{-\alpha}
    $$
\end{itemize}
